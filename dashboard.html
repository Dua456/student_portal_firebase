<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="dashboard.css">
</head>

<body>
    <div id="dashboardPage" class="dashboard">
        <!-- Navbar -->
        <nav class="navbar">
            <div class="navbar-left">
                <button class="menu-toggle" onclick="toggleSidebar()">‚ò∞</button>
                <h1>Admin Dashboard</h1>
            </div>
            <button class="btn-logout" onclick="logout()">Logout</button>
        </nav>

        <div class="main-container">
            <!-- Sidebar Overlay -->
            <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

            <!-- Sidebar -->
            <aside id="sidebar" class="sidebar">
                <div class="sidebar-menu">
                    <div class="menu-item active" onclick="showPage('dashboard', event)">
                        <span class="menu-icon">üè†</span>
                        <span>Dashboard</span>
                    </div>
                    <div class="menu-item" onclick="showPage('enrollment', event)">
                        <span class="menu-icon">üë•</span>
                        <span>Student Enrollment</span>
                    </div>
                    <div class="menu-item" onclick="showPage('registration', event)">
                        <span class="menu-icon">‚ûï</span>
                        <span>Student Registration</span>
                    </div>
                    <div class="menu-item" onclick="showPage('payment', event)">
                        <span class="menu-icon">üí∞</span>
                        <span>Payment</span>
                    </div>
                    <div class="menu-item" onclick="showPage('courses', event)">
                        <span class="menu-icon">üìö</span>
                        <span>Courses</span>
                    </div>
                    <div class="menu-item" onclick="showPage('attendance', event)">
                        <span class="menu-icon">üìÖ</span>
                        <span>Attendance</span>
                    </div>
                    <div class="menu-item" onclick="showPage('assignment', event)">
                        <span class="menu-icon">üìù</span>
                        <span>Assignments</span>
                    </div>
                </div>
            </aside>

            <!-- Content -->
            <main class="content">
                <!-- Dashboard Page -->
                <div id="dashboardContent" class="page active">
                    <h2 style="margin-bottom: 20px; color: #333;">Dashboard Overview</h2>
                    <div class="stats-grid">
                        <div class="stat-card blue">
                            <h3>Total Students</h3>
                            <p id="totalStudents">0</p>
                        </div>
                        <div class="stat-card green">
                            <h3>Total Payments</h3>
                            <p id="totalPayments">Rs 0</p>
                        </div>
                        <div class="stat-card purple">
                            <h3>Courses</h3>
                            <p>5</p>
                        </div>
                        <div class="stat-card orange">
                            <h3>Attendance</h3>
                            <p>0%</p>
                        </div>
                    </div>

                    <div class="card">
                        <h2>Recent Students</h2>
                        <div class="table-responsive">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Image</th>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Course</th>
                                        <th>Campus</th>
                                        <th>Teacher</th>
                                        <th>Days</th>
                                        <th>Timing</th>
                                    </tr>
                                </thead>
                                <tbody id="recentStudentsTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Enrollment Page -->
                <div id="enrollmentContent" class="page">
                    <div class="card">
                        <h2>Student Enrollment</h2>
                        <div class="table-responsive">
                            <table>
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Image</th>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Course</th>
                                        <th>Phone</th>
                                        <th>Campus</th>
                                        <th>Teacher</th>
                                        <th>Days</th>
                                        <th>Timing</th>
                                        <th>Enroll Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="enrollmentTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Registration Page -->
                <div id="registrationContent" class="page">
                    <div class="card">
                        <h2 id="formTitle">Student Registration</h2>
                        <div class="form-container">
                            <div class="form-grid">
                                <div class="form-row">
                                    <label>Student Image *</label>
                                    <input type="file" id="studentImage" accept="image/*"
                                        onchange="previewImage(event)">
                                    <div id="imagePreview" class="image-preview"></div>
                                </div>

                                <div class="form-row">
                                    <label>Student Name *</label>
                                    <input type="text" id="studentName" placeholder="Enter student name">
                                </div>

                                <div class="form-row">
                                    <label>Email *</label>
                                    <input type="email" id="studentEmail" placeholder="Enter email">
                                </div>

                                <div class="form-row">
                                    <label>Phone *</label>
                                    <input type="tel" id="studentPhone" placeholder="e.g., 0300-1234567">
                                </div>

                                <div class="form-row">
                                    <label>Course *</label>
                                    <select id="studentCourse">
                                        <option value="">Select Course</option>
                                        <option value="Web Development">Web Development</option>
                                        <option value="Graphic Design">Graphic Design</option>
                                        <option value="Mobile App Development">Mobile App Development</option>
                                        <option value="Digital Marketing">Digital Marketing</option>
                                        <option value="Data Science">Data Science</option>
                                    </select>
                                </div>

                                <div class="form-row">
                                    <label>Campus *</label>
                                    <select id="studentCampus">
                                        <option value="">Select Campus</option>
                                        <option value="Main Campus">Main Campus</option>
                                        <option value="North Campus">North Campus</option>
                                        <option value="South Campus">South Campus</option>
                                        <option value="East Campus">East Campus</option>
                                        <option value="West Campus">West Campus</option>
                                    </select>
                                </div>

                                <div class="form-row">
                                    <label>Teacher *</label>
                                    <select id="studentTeacher">
                                        <option value="">Select Teacher</option>
                                        <option value="Sir Ahmed">Sir Ahmed</option>
                                        <option value="Sir Hassan">Sir Hassan</option>
                                        <option value="Miss Ayesha">Miss Ayesha</option>
                                        <option value="Sir Ali">Sir Ali</option>
                                        <option value="Miss Fatima">Miss Fatima</option>
                                    </select>
                                </div>

                                <div class="form-row">
                                    <label>Days *</label>
                                    <select id="studentDays">
                                        <option value="">Select Days</option>
                                        <option value="Monday - Wednesday - Friday">Monday - Wednesday - Friday</option>
                                        <option value="Tuesday - Thursday - Saturday">Tuesday - Thursday - Saturday
                                        </option>
                                        <option value="Monday to Friday">Monday to Friday</option>
                                        <option value="Saturday - Sunday">Saturday - Sunday</option>
                                    </select>
                                </div>

                                <div class="form-row">
                                    <label>Timing *</label>
                                    <select id="studentTiming">
                                        <option value="">Select Timing</option>
                                        <option value="9:00 AM - 12:00 PM">9:00 AM - 12:00 PM</option>
                                        <option value="12:00 PM - 3:00 PM">12:00 PM - 3:00 PM</option>
                                        <option value="3:00 PM - 6:00 PM">3:00 PM - 6:00 PM</option>
                                        <option value="6:00 PM - 9:00 PM">6:00 PM - 9:00 PM</option>
                                    </select>
                                </div>

                                <div class="form-row">
                                    <label>Enrollment Date *</label>
                                    <input type="date" id="studentEnrollDate">
                                </div>
                            </div>

                            <button class="btn-submit" onclick="registerStudent()" id="submitBtn">Register
                                Student</button>
                        </div>
                    </div>
                </div>

                <!-- Payment Page -->
                <div id="paymentContent" class="page">
                    <div class="card">
                        <h2>Payment Records</h2>
                        <div class="table-responsive">
                            <table>
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Student Name</th>
                                        <th>Amount</th>
                                        <th>Date</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="paymentTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Courses Page -->
                <div id="coursesContent" class="page">
                    <div class="card">
                        <h2>Available Courses</h2>
                        <div class="course-grid">
                            <div class="course-card">
                                <h3>Web Development</h3>
                                <p>Duration: 6 months</p>
                                <p>Fee: Rs 4,000</p>
                            </div>
                            <div class="course-card">
                                <h3>Graphic Design</h3>
                                <p>Duration: 6 months</p>
                                <p>Fee: Rs 3,000</p>
                            </div>
                            <div class="course-card">
                                <h3>Mobile App Development</h3>
                                <p>Duration: 8 months</p>
                                <p>Fee: Rs 7,000</p>
                            </div>
                            <div class="course-card">
                                <h3>Digital Marketing</h3>
                                <p>Duration: 4 months</p>
                                <p>Fee: Rs 4,000</p>
                            </div>
                            <div class="course-card">
                                <h3>Data Science</h3>
                                <p>Duration: 10 months</p>
                                <p>Fee: Rs 5,000</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Attendance Page -->
                <div id="attendanceContent" class="page">
                    <div class="card">
                        <h2>Attendance Records</h2>
                        <div class="table-responsive">
                            <table>
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Student Name</th>
                                        <th>Date</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="attendanceTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Assignment Page -->
                <div id="assignmentContent" class="page">
                    <div class="card">
                        <h2>Assignments</h2>
                        <div class="course-grid">
                            <div class="course-card">
                                <h3>JavaScript Basics</h3>
                                <p>Due Date: 2024-10-15</p>
                                <p>Status: Pending</p>
                            </div>
                            <div class="course-card">
                                <h3>React Components</h3>
                                <p>Due Date: 2024-10-20</p>
                                <p>Status: Pending</p>
                            </div>
                            <div class="course-card">
                                <h3>Database Design</h3>
                                <p>Due Date: 2024-10-25</p>
                                <p>Status: Pending</p>
                            </div>
                            <div class="course-card">
                                <h3>UI/UX Project</h3>
                                <p>Due Date: 2024-10-30</p>
                                <p>Status: Pending</p>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // Global variables
        let students = [];
        let editingId = null;

        // Load data from memory
        function loadData() {
            students = JSON.parse(localStorage.getItem("students")) || [];
            renderTables();
        }

        // Save data to memory
        function saveData() {
            localStorage.setItem("students", JSON.stringify(students));
        }

        // Sidebar toggle with overlay
        function toggleSidebar() {
            const sidebar = document.getElementById("sidebar");
            const overlay = document.getElementById("sidebarOverlay");
            sidebar.classList.toggle("show");
            overlay.classList.toggle("show");
        }

        // Show page
        function showPage(page, event) {
            document.querySelectorAll(".menu-item").forEach(item => item.classList.remove("active"));
            if (event) event.currentTarget.classList.add("active");

            document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
            document.getElementById(page + "Content").classList.add("active");

            // Close sidebar on mobile after selecting a page
            if (window.innerWidth <= 768) {
                toggleSidebar();
            }
        }

        // Logout
        function logout() {
            if(confirm('Are you sure you want to logout?')) {
                window.location.href = 'login.html';
            }
        }
        

        // Image preview
        function previewImage(event) {
            const reader = new FileReader();
            reader.onload = function () {
                const output = document.getElementById('imagePreview');
                output.innerHTML = `<img src="${reader.result}" style="max-width:100px; max-height:100px; border-radius:50%;">`;
            };
            reader.readAsDataURL(event.target.files[0]);
        }

        // Register or Update student
        function registerStudent() {
            const name = document.getElementById("studentName").value.trim();
            const email = document.getElementById("studentEmail").value.trim();
            const phone = document.getElementById("studentPhone").value.trim();
            const course = document.getElementById("studentCourse").value;
            const campus = document.getElementById("studentCampus").value;
            const teacher = document.getElementById("studentTeacher").value;
            const days = document.getElementById("studentDays").value;
            const timing = document.getElementById("studentTiming").value;
            const enrollDate = document.getElementById("studentEnrollDate").value;
            const imageFile = document.getElementById("studentImage").files[0];

            // Validation
            if (!name || !email || !phone || !course || !campus || !teacher || !days || !timing || !enrollDate) {
                alert("Please fill all required fields!");
                return;
            }

            // If editing and no new image, keep old image
            if (editingId !== null && !imageFile) {
                const student = students.find(s => s.id === editingId);
                updateStudent(student.image);
                return;
            }

            if (!imageFile && editingId === null) {
                alert("Please select an image!");
                return;
            }

            const reader = new FileReader();
            reader.onload = function () {
                if (editingId !== null) {
                    updateStudent(reader.result);
                } else {
                    addStudent(reader.result);
                }
            };
            reader.readAsDataURL(imageFile);
        }

        // Add new student
        function addStudent(imageData) {
            const student = {
                id: students.length ? Math.max(...students.map(s => s.id)) + 1 : 1,
                name: document.getElementById("studentName").value.trim(),
                email: document.getElementById("studentEmail").value.trim(),
                phone: document.getElementById("studentPhone").value.trim(),
                course: document.getElementById("studentCourse").value,
                campus: document.getElementById("studentCampus").value,
                teacher: document.getElementById("studentTeacher").value,
                days: document.getElementById("studentDays").value,
                timing: document.getElementById("studentTiming").value,
                enrollDate: document.getElementById("studentEnrollDate").value,
                image: imageData
            };

            students.push(student);
            saveData();
            alert("Student Registered Successfully!");
            clearForm();
            renderTables();
        }
        // Update existing student
        function updateStudent(imageData) {
            const index = students.findIndex(s => s.id === editingId);
            if (index !== -1) {
                students[index] = {
                    id: editingId,
                    name: document.getElementById("studentName").value.trim(),
                    email: document.getElementById("studentEmail").value.trim(),
                    phone: document.getElementById("studentPhone").value.trim(),
                    course: document.getElementById("studentCourse").value,
                    campus: document.getElementById("studentCampus").value,
                    teacher: document.getElementById("studentTeacher").value,
                    days: document.getElementById("studentDays").value,
                    timing: document.getElementById("studentTiming").value,
                    enrollDate: document.getElementById("studentEnrollDate").value,
                    image: imageData
                };

                saveData();
                alert("Student Updated Successfully!");
                clearForm();
                renderTables();
            }
        }

        // Edit student
        function editStudent(id) {
            const student = students.find(s => s.id === id);
            if (student) {
                editingId = id;
                document.getElementById("studentName").value = student.name;
                document.getElementById("studentEmail").value = student.email;
                document.getElementById("studentPhone").value = student.phone;
                document.getElementById("studentCourse").value = student.course;
                document.getElementById("studentCampus").value = student.campus;
                document.getElementById("studentTeacher").value = student.teacher;
                document.getElementById("studentDays").value = student.days;
                document.getElementById("studentTiming").value = student.timing;
                document.getElementById("studentEnrollDate").value = student.enrollDate;
                document.getElementById("imagePreview").innerHTML = `<img src="${student.image}" style="max-width:100px; max-height:100px; border-radius:50%;">`;
                
                document.getElementById("formTitle").innerText = "Update Student";
                document.getElementById("submitBtn").innerText = "Update Student";
                
                showPage('registration', null);
                document.querySelectorAll(".menu-item").forEach(item => item.classList.remove("active"));
                document.querySelectorAll(".menu-item")[2].classList.add("active");
            }
        }

        // Clear form
        function clearForm() {
            editingId = null;
            document.getElementById("studentName").value = "";
            document.getElementById("studentEmail").value = "";
            document.getElementById("studentPhone").value = "";
            document.getElementById("studentCourse").value = "";
            document.getElementById("studentCampus").value = "";
            document.getElementById("studentTeacher").value = "";
            document.getElementById("studentDays").value = "";
            document.getElementById("studentTiming").value = "";
            document.getElementById("studentEnrollDate").value = "";
            document.getElementById("studentImage").value = "";
            document.getElementById("imagePreview").innerHTML = "";
            document.getElementById("formTitle").innerText = "Student Registration";
            document.getElementById("submitBtn").innerText = "Register Student";
        }

        // Delete student
        function deleteStudent(id) {
            if (confirm("Are you sure you want to delete this student?")) {
                students = students.filter(s => s.id !== id);
                saveData();
                renderTables();
                alert("Student deleted successfully!");
            }
        }

        // Render tables
        function renderTables() {
            const enrollmentTable = document.getElementById("enrollmentTable");
            const recentTable = document.getElementById("recentStudentsTable");

            enrollmentTable.innerHTML = "";
            recentTable.innerHTML = "";

            let totalPayments = 0;

            students.forEach(student => {
                enrollmentTable.innerHTML += `
                <tr>
                    <td>${student.id}</td>
                    <td><img src="${student.image}" style="width:50px;height:50px;border-radius:50%;object-fit:cover;"></td>
                    <td>${student.name}</td>
                    <td>${student.email}</td>
                    <td>${student.course}</td>
                    <td>${student.phone}</td>
                    <td>${student.campus}</td>
                    <td>${student.teacher}</td>
                    <td>${student.days}</td>
                    <td>${student.timing}</td>
                    <td>${student.enrollDate}</td>
                    <td>
                        <button class="btn-edit" onclick="editStudent(${student.id})">Edit</button>
                        <button class="btn-delete" onclick="deleteStudent(${student.id})">Delete</button>
                    </td>
                </tr>
                `;

                recentTable.innerHTML += `
                <tr>
                    <td><img src="${student.image}" style="width:40px;height:40px;border-radius:50%;object-fit:cover;"></td>
                    <td>${student.name}</td>
                    <td>${student.email}</td>
                    <td>${student.course}</td>
                    <td>${student.campus}</td>
                    <td>${student.teacher}</td>
                    <td>${student.days}</td>
                    <td>${student.timing}</td>
                </tr>
                `;

                totalPayments += 4000;
            });

            document.getElementById("totalStudents").innerText = students.length;
            document.getElementById("totalPayments").innerText = `Rs ${totalPayments.toLocaleString()}`;
        }

        // Initialize on page load
        window.addEventListener('DOMContentLoaded', function() {
            loadData();
        });

        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const toggle = document.querySelector('.menu-toggle');
            const isClickInsideSidebar = sidebar.contains(event.target);
            const isClickOnToggle = toggle.contains(event.target);

            if (!isClickInsideSidebar && !isClickOnToggle && sidebar.classList.contains('show')) {
                toggleSidebar();
            }
        });
    </script>
</body>
</html>